% Required changes
\addbibresource{content/misc/literature.bib}

\input{template/dhbw-bibstyle}
\input{template/dhbw-citestyle}

\graphicspath{ {content/assets/} }



%**************************************************************
% Acronyms
%
\usepackage[printonlyused]{acronym}

%**************************************************************
% Util for the non-disclosure notice lettering on the title page
%
\usepackage{rotating}
\usepackage[absolute]{textpos}

%**************************************************************
% Custom macros
%
\newcommand{\subcaption}[1] {
  \begin{center}
    \footnotesize{#1}
  \end{center}
}

\usepackage{xparse}
\NewDocumentEnvironment{subcaptionenv}{m}{}{\subcaption{#1}}

%**************************************************************
% Fix: New paragraph is not indent
% NOTE: Has to be loaded after the package tocloft
%
\usepackage[parfill]{parskip}
\usepackage{plantuml} % has to be loaded here. why? idk -.-


\makeatletter
\newcommand\pagenumberingnoreset[1]{\gdef\thepage{\csname @#1\endcsname\c@page}}
\makeatother

\usepackage{pgfkeys}

\newif\ifdebug

\pgfkeys{
  /dhbw/.cd,
  author/.store in            = \dhbwGetAuthor,
  faculty/.store in           = \dhbwGetFaculty,
  field of study/.store in    = \dhbwGetFieldOfStudy,
  academic year/.store in     = \dhbwGetAcademicYear,
  course/.store in            = \dhbwGetCourse,
  title/.store in             = \dhbwGetTitle,
  subtitle/.store in          = \dhbwGetSubtitle,
  text type/.store in         = \dhbwGetTextType,
  company name/.store in      = \dhbwGetCompanyName,
  company logo/.store in      = \dhbwGetCompanyLogo,
  lecturer/.store in          = \dhbwGetLecturer,
  location/.store in          = \dhbwGetLocation,
  date/.store in              = \dhbwGetDate,
  longest acronym/.store in   = \dhbwGetLongestAcronym,
  acronyms/.store in          = \dhbwGetAcronyms,
  debug/.is if                = debug
}

\newrobustcmd\dhbwSetup[1]{\pgfqkeys{/dhbw}{#1}}

\newcommand{\dhbwSetFrontMatter}{%
  \selectlanguage{ngerman}
  \pagenumbering{gobble}
}

\newcommand{\dhbwPrintTitle}{%
  \input{template/title.tex}
}

\newcommand{\dhbwPrintNonDisclosureNotice}{%
  \newpage  
  \input{template/non-disclosure-notice.tex}
}

\newcommand{\dhbwPrintTableOfContents}{%
  \newpage
  \setcounter{page}{2}
  \tableofcontents
}

\newcommand{\dhbwSetListMatter}{%
  \newpage
  \pagenumberingnoreset{Roman}
}

\newcommand{\dhbwPrintListOfAcronyms}{%
  \newpage
  \section*{Abkürzungsverzeichnis}\addcontentsline{toc}{section}{Abkürzungsverzeichnis}
  \begin{acronym}[\dhbwGetLongestAcronym{}\dhbwGetLongestAcronym{}] % spacing between acronym and long name
    \setlength{\itemsep}{-\parsep} % line spacing
    \dhbwGetAcronyms
  \end{acronym}
} 

\newcommand{\dhbwPrintListOfFigures}{%
  \newpage
  \listoffigures\addcontentsline{toc}{section}{\listfigurename}
}

\newcommand{\dhbwPrintListOfTables}{%
  \newpage
  \listoftables\addcontentsline{toc}{section}{\listtablename}
}

\newcommand{\dhbwPrintListOfListings}{%
  \newpage
  \lstlistoflistings\addcontentsline{toc}{section}{\lstlistlistingname}
}

\newcommand{\dhbwSetMainMatter}{%
  \newpage
  \pagenumbering{arabic}
  \setcounter{page}{1}
}

\newcommand{\dhbwPrintBibliography}{%
  \newpage
  \printbibtabular[title=\contentsname]\addcontentsline{toc}{section}{\contentsname}
}

\newcommand{\dhbwPrintIndependenceNotice}{%
  \newpage
  \input{template/independence-notice.tex}
}

\newcommand{\dhbwPrintEverythingBefore}{%
  \dhbwSetFrontMatter
  \dhbwPrintTitle
  \dhbwPrintNonDisclosureNotice
  \dhbwPrintTableOfContents
  \dhbwSetListMatter
  \dhbwPrintListOfAcronyms
  \dhbwPrintListOfFigures
  \dhbwPrintListOfTables
  \dhbwPrintListOfListings
  \dhbwSetMainMatter
}

\newcommand{\dhbwPrintEverythingAfter}{%
  \dhbwPrintBibliography
  \dhbwPrintIndependenceNotice
}
